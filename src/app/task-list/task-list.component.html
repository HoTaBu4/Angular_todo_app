<ul class="task-list list-unstyled m-0 p-0">
  @for (task of tasks; track trackByTaskName; let index = $index) {
    <li class="task-item border rounded-3 bg-white" [ngClass]="{ 'task-item--completed': task.status === 'Completed' }">
      <div class="task-item__body">
        <div class="task-item__main">
          <div class="form-check task-item__check">
            <input
              type="checkbox"
              class="form-check-input"
              [checked]="task.status === 'Completed'"
              (change)="onToggleCompleted(task)"
              [attr.aria-label]="'Oznacz jako ukończone: ' + task.name">
          </div>

          <div class="task-item__content">
            <div class="task-item__headline">
              <h2 class="task-item__title h5 mb-0">{{ task.name }}</h2>
              <span class="badge" [ngClass]="getBadgeClass(task.status)">{{ task.status }}</span>
            </div>
            <p class="task-item__meta text-body-secondary mb-0">
              Termin: <time [attr.datetime]="task.date">{{ task.date | date: 'dd.MM.yyyy' }}</time>
            </p>
          </div>

          <button
            type="button"
            class="task-item__toggle btn btn-link text-decoration-none p-0"
            (click)="onToggleDescription(task)"
            [attr.aria-expanded]="task.isExpanded === true"
            [attr.aria-controls]="'task-desc-' + index">
            {{ task.isExpanded ? 'Ukryj' : 'Pokaż' }} opis
          </button>
        </div>

        @if (task.isExpanded) {
          <div class="task-item__description text-body-secondary" [id]="'task-desc-' + index">
            {{ task.description }}
          </div>
        }
      </div>
    </li>
  }
</ul>
